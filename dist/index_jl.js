import{defineInterface as e}from"@directus/extensions-sdk";import{defineComponent as r,ref as t,onMounted as n,watch as i,openBlock as l,createElementBlock as u,createBlock as a,resolveDynamicComponent as o,computed as c,resolveComponent as d,resolveDirective as s,Fragment as v,createVNode as p,unref as f,isRef as m,withCtx as y,createCommentVNode as b,withDirectives as h,withModifiers as g}from"vue";import{useI18n as _}from"vue-i18n";import k from"get-video-id";import I from"plyr";const x={class:"wrapper"};var C=r({__name:"plyr",props:{service:{},id:{}},setup(e){const r=e,c=t();let d;function s(e){return`/assets/${e}`}return n((()=>{d=new I(c.value,{youtube:{noCookie:!0}})})),i([()=>r.service,()=>r.id],(function(){d.source={type:"video",sources:["directus"==r.service?{src:s(r.id),type:"video/mp4"}:{src:r.id,provider:r.service}]}})),(e,r)=>(l(),u("div",x,[(l(),a(o("directus"==e.service?"video":"div"),{ref_key:"el",ref:c,src:"directus"==e.service?s(e.id):null,playsinline:"directus"==e.service,controls:"directus"==e.service,type:"directus"==e.service?"video/mp4":null,"data-plyr-provider":"directus"!=e.service?e.service:null,"data-plyr-embed-id":"directus"!=e.service?e.id:null},null,8,["src","playsinline","controls","type","data-plyr-provider","data-plyr-embed-id"]))]))}}),w=[],V=[];function D(e,r){if(e&&"undefined"!=typeof document){var t,n=!0===r.prepend?"prepend":"append",i=!0===r.singleTag,l="string"==typeof r.container?document.querySelector(r.container):document.getElementsByTagName("head")[0];if(i){var u=w.indexOf(l);-1===u&&(u=w.push(l)-1,V[u]={}),t=V[u]&&V[u][n]?V[u][n]:V[u][n]=a()}else t=a();65279===e.charCodeAt(0)&&(e=e.substring(1)),t.styleSheet?t.styleSheet.cssText+=e:t.appendChild(document.createTextNode(e))}function a(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),r.attributes)for(var t=Object.keys(r.attributes),i=0;i<t.length;i++)e.setAttribute(t[i],r.attributes[t[i]]);var u="prepend"===n?"afterbegin":"beforeend";return l.insertAdjacentElement(u,e),e}}D("\n@import 'plyr';\n:root {\n        --plyr-color-main: var(--theme--primary);\n        --plyr-control-radius: var(--theme--border-radius);\n        --plyr-font-family: var(--theme--fonts--sans--font-family);\n        --plyr-font-weight-regular: var(--theme--fonts--sans--font-weight);\n}\n",{});D("\n.wrapper[data-v-dadd26db] {\n        margin-top: 4px;\n        border-radius: var(--theme--border-radius);\n        border: var(--theme--border-width) solid var(--v-input-border-color, var(--theme--form--field--input--border-color));\n        overflow: hidden;\n}\n",{});var S=(e,r)=>{const t=e.__vccOpts||e;for(const[e,n]of r)t[e]=n;return t},A=S(C,[["__scopeId","data-v-dadd26db"],["__file","plyr.vue"]]),T=r({__name:"interface",props:{value:{}},emits:["input"],setup(e,{emit:r}){const n=e,o=r,{t:I}=_(),{services:x,service:C}={service:t(null),services:[{value:"directus",text:"Directus"},{value:"youtube",text:"YouTube"},{value:"vimeo",text:"Vimeo"}]},{fileDrawer:w,fileID:V,setFileSelection:D}=function(e){const r=t(!1),n=t(null);return i(e,(function(e,t){e==t||"directus"!=e||n.value||(r.value=!0)})),{fileDrawer:r,fileID:n,setFileSelection:async function(e){var r;if(!e)return;n.value=null!=(r=e[0])?r:null}}}(C),{idInput:S,inputIsClickable:T,inputPlaceholder:j,onInputClick:E}=function(e,r){const n=t(null),i=c((()=>!e.value||"directus"==e.value)),l=c((()=>{if(e.value)return"directus"==e.value?I("choose_from_library"):"Video ID â€¦"}));return{idInput:n,inputIsClickable:i,inputPlaceholder:l,onInputClick:function({target:t}){if(!i.value)return;if(!(null==t?void 0:t.closest(".prepend .v-select"))&&"directus"==e.value)return void(r.value=!0);const n=null==t?void 0:t.querySelector(".prepend .v-menu-activator > *");null==n||n.click()}}}(C,w),{id:O,clearID:P}=function(e,r,t){const n=c({get(){if(e.value)return"directus"==e.value?t.value:r.value},set(e){const{id:t}=k(null!=e?e:"");r.value=null!=t?t:e}});return{id:n,clearID:function(){if("directus"==e.value)return void(t.value=null);n.value=null}}}(C,S,V);return i((()=>n.value),(function(){if(!n.value)return;if(C.value=n.value.service,"directus"==C.value)return void(V.value=n.value.id);O.value=n.value.id})),i([C,O],(function(){var e,r;if((null==(e=n.value)?void 0:e.service)==C.value&&(null==(r=n.value)?void 0:r.id)==O.value)return;const i=C.value&&O.value?{service:C.value,id:O.value}:null;o("input",t(i))})),(e,r)=>{const t=d("v-select"),n=d("v-icon"),i=d("v-input"),o=d("drawer-files"),c=s("tooltip");return l(),u(v,null,[p(i,{modelValue:f(O),"onUpdate:modelValue":r[1]||(r[1]=e=>m(O)?O.value=e:null),clickable:f(T),onClick:f(E),placeholder:f(j)},{prepend:y((()=>[p(t,{modelValue:f(C),"onUpdate:modelValue":r[0]||(r[0]=e=>m(C)?C.value=e:null),items:f(x),inline:"",placeholder:f(I)("source"),placement:"bottom-start"},null,8,["modelValue","items","placeholder"])])),append:y((()=>["directus"!=f(C)||f(O)?b("v-if",!0):(l(),a(n,{key:0,name:"attach_file"})),f(C)&&f(O)?h((l(),a(n,{key:1,class:"deselect",name:"close",onClick:g(f(P),["stop"]),clickable:""},null,8,["onClick"])),[[c,f(I)("deselect")]]):b("v-if",!0)])),_:1},8,["modelValue","clickable","onClick","placeholder"]),p(o,{active:f(w),"onUpdate:active":r[2]||(r[2]=e=>w.value=!1),onInput:f(D)},null,8,["active","onInput"]),f(C)&&f(O)?(l(),a(A,{key:0,service:f(C),id:f(O)},null,8,["service","id"])):b("v-if",!0)],64)}}});D("\n.v-input[data-v-c8133a61] .input .prepend {\n        margin-right: 16px;\n}\n.deselect[data-v-c8133a61]:hover {\n        --v-icon-color-hover: var(--theme--danger);\n}\n",{});var j=e({id:"co-defy-video-player",name:"Video Player",icon:"smart_display",description:"An interface for embedding a video player",component:S(T,[["__scopeId","data-v-c8133a61"],["__file","interface.vue"]]),types:["json"],group:"selection",options:null});export{j as default};
